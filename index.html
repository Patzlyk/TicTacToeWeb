<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Patrikovy naprosto úžasné piškvorky</title>
    <style>
    	* { padding: 0; margin: 0; }
    	canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<a>Skvěle fungující a nerozbité piškvorky</a>
<canvas id="gameCanvas" width="1280" height="720"></canvas>

<script>
    var canv = document.getElementById("gameCanvas");
    var context = canv.getContext("2d");

    document.addEventListener("click", mouseClickHandler, false)

    var nextTurnPlayer = 0;
    var gameSize = 5;

    function mouseClickHandler(e)
    {
        var a = canv.getBoundingClientRect()

        var clickedX = e.clientX - a.left;
        var clickedY = e.clientY - a.top;

        var clickedGameX = Math.round((clickedX - 25) / 50);
        var clickedGameY = Math.round((clickedY - 25) / 50);

        placeMark(clickedGameX, clickedGameY);
    }

    function placeMark(posX, posY)
    {
        if (nextTurnPlayer == 0)
        {
            drawCross(posX, posY);
            nextTurnPlayer = 1;
        }
        else
        {
            drawCircle(posX, posY);
            nextTurnPlayer = 0;
        }

        if (posX > gameSize - 1 || posY > gameSize - 1)
        {
            drawWarningText();
        }

        drawCurrentPlayerText();
    }

    function drawCross(posX, posY)
    {
        context.beginPath();
        context.lineWidth = 5;
        context.strokeStyle = "#FF0000";
        context.moveTo(posX * 50 + 5, posY * 50 + 5);
        context.lineTo(posX * 50 + 45, posY * 50 + 45);
        context.stroke();
        context.moveTo(posX * 50 + 45, posY * 50 + 5);
        context.lineTo(posX * 50 + 5, posY * 50 + 45);
        context.stroke();
        context.closePath();
    }

    function drawCircle(posX, posY)
    {
        context.beginPath();
        context.lineWidth = 5;
        context.strokeStyle = "#00AAFF";
        context.arc(posX * 50 + 25, posY * 50 + 25, 20, 0, Math.PI * 2)
        context.stroke();
        context.closePath();
    }

    function drawGameField(size)
    {
        context.beginPath();
        context.lineWidth = 2;
        context.strokeStyle = "#000000";
        for (var i = 1; i < size; i++)
        {
            context.moveTo(0, i * 50);
            context.lineTo(size * 50, i * 50)
            context.stroke();
            context.moveTo(i * 50, 0);
            context.lineTo(i * 50, size * 50)
            context.stroke();
        }

        context.closePath();
    }

    function drawCurrentPlayerText()
    {
        context.clearRect(gameSize * 50 + 50, 60, 160, 50)

        context.beginPath();
        context.fillStyle = "#000000";
        context.font = "40px Arial"
        context.fillText("Hraje:", gameSize * 50 + 50, 100);
        context.closePath();

        if (nextTurnPlayer == 0)
        {
            context.beginPath();
            context.lineWidth = 5;
            context.strokeStyle = "#FF0000";
            context.moveTo(gameSize * 50 + 165, 60 + 5);
            context.lineTo(gameSize * 50 + 205, 60 + 45);
            context.stroke();
            context.moveTo(gameSize * 50 + 205, 60 + 5);
            context.lineTo(gameSize * 50 + 165, 60 + 45);
            context.stroke();
        }
        else
        {
            context.beginPath();
            context.lineWidth = 5;
            context.strokeStyle = "#00AAFF";
            context.arc(gameSize * 50 + 185, 85, 20, 0, Math.PI * 2)
            context.stroke();
            context.closePath();
        }
    }

    function drawWarningText()
    {
        context.beginPath();
        context.fillStyle = "#FF0000";
        context.font = "60px Arial";
        context.fillText("Nesnaž se to rozbít nebo bude zle!", 10, 500);
        context.closePath();
    }

    drawGameField(gameSize);
    drawCurrentPlayerText();

</script>

</body>
</html>